# ============================================================================
# ENVIRONMENT CONFIGURATION
# ============================================================================
# This file contains environment variables for LOCAL DEVELOPMENT.
# 
# For Vercel deployments (Production/Preview), set these in:
# Vercel Dashboard → Settings → Environment Variables
#
# Environment Types:
# - Production: Live site (main branch) - Use production database & services
# - Preview: PR/branch deployments - Use preview/staging database & services  
# - Development: Local development - Use local file database (file:./local.db)
#
# See ENVIRONMENT_SETUP_GUIDE.md for detailed setup instructions
# ============================================================================

# Google Analytics
# Production: Your production GA ID
# Preview: Can use same or separate GA property
# Development: Optional (can leave empty)
NEXT_PUBLIC_GA_ID=your-google-analytics-id

# Site Configuration
# Production: Set to your production domain (e.g., https://huculturehub.com)
# Preview: Leave empty (will use VERCEL_URL automatically)
# Development: http://localhost:3000
# Vercel automatically provides VERCEL_URL for preview deployments,
# but you should set NEXT_PUBLIC_SITE_URL for production domain
NEXT_PUBLIC_SITE_URL=https://huculturehub.com

# Development
# This is automatically set by Vercel (production/preview) or Next.js (development)
# Do not override in Vercel - it's set automatically
NODE_ENV=development
# Set to false to enable API routes in development (default: false)
STATIC_EXPORT=false

# ============================================================================
# Authentication (NextAuth.js v5 - 2025)
# ============================================================================
# NextAuth.js Configuration
# Generate AUTH_SECRET with: openssl rand -base64 32
# Production: Use production secret (keep secure!)
# Preview: Can use same or separate secret
# Development: Generate with: openssl rand -base64 32
AUTH_SECRET=your-auth-secret-here

# Authentication URL
# Production: https://huculturehub.com (your production domain)
# Preview: Leave empty (will use VERCEL_URL) or set to preview URL
# Development: http://localhost:3000
AUTH_URL=http://localhost:3000

# Google OAuth (for Google Workspace authentication)
# Get credentials from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Google Workspace Domain Restriction
# Only users from this domain can sign in (e.g., huculturehub.com)
GOOGLE_WORKSPACE_DOMAIN=yourdomain.com

# ============================================================================
# Turso Database (SQLite)
# ============================================================================
# IMPORTANT: Use DIFFERENT databases for each environment!
#
# Production: libsql://your-production-db.turso.io
#   - Create a dedicated production database in Turso
#   - Never share with preview/development
#
# Preview: libsql://your-preview-db.turso.io
#   - Create a separate preview/staging database
#   - Use for testing before production
#
# Development: file:./local.db
#   - Local file database (no token needed)
#   - Automatically created on first run
#
# Setup: https://vercel.com/marketplace/tursocloud
# See ENVIRONMENT_SETUP_GUIDE.md for detailed instructions
TURSO_DATABASE_URL=file:./local.db
TURSO_AUTH_TOKEN=

# ============================================================================
# Vercel Blob Storage
# ============================================================================
# Automatically set when using Vercel Blob Storage
# For local development, you can leave this empty
# Setup: https://vercel.com/docs/storage/vercel-blob
BLOB_READ_WRITE_TOKEN=

# ============================================================================
# Rate Limiting Configuration
# ============================================================================
# Number of requests allowed per window
RATE_LIMIT=5
# Time window in seconds (e.g., 600 = 10 minutes)
RATE_WINDOW_SECONDS=600
# Use device fingerprint (IP + User-Agent + headers) instead of IP only
# Set to 'false' to use only IP address (less accurate but simpler)
RATE_LIMIT_USE_FINGERPRINT=true
# Fail-closed on rate limit errors (reject requests when rate limiting fails)
# Production: 'true' (strict security)
# Preview: 'true' (test like production)
# Development: 'false' or leave empty (permissive for debugging)
# If not set: fail-closed in production/preview, fail-open in development
RATE_LIMIT_FAIL_CLOSED=

# BlackForest Lab API (Flux1 Kontext Pro)
# Get your API key from: https://bfl.ai/
# API Documentation: https://docs.bfl.ai/
PROVIDER_API_KEY=your_blackforest_lab_api_key_here

# BFL API Endpoint (optional, defaults to global endpoint)
# Options: https://api.bfl.ai (global), https://api.eu.bfl.ai (EU), https://api.us.bfl.ai (US)
# See: https://docs.bfl.ai/api_integration/integration_guidelines#api-endpoints-overview
BFL_API_URL=https://api.bfl.ai/v1/flux-kontext-pro

# Google reCAPTCHA v2
# Get your keys from: https://www.google.com/recaptcha/admin
# Site Key is public (safe to expose) - Secret Key must be kept private
# Choose "reCAPTCHA v2" and "I'm not a robot" Checkbox option
NEXT_PUBLIC_RECAPTCHA_SITE_KEY=your_site_key_here
RECAPTCHA_SECRET_KEY=your_secret_key_here

# ============================================================================
# Email Configuration (Google Workspace SMTP)
# ============================================================================
# IMPORTANT: For Google Workspace/Gmail, you MUST use an App Password, NOT your regular password
# 
# Setup Instructions:
# 1. Enable 2-Step Verification: https://myaccount.google.com/security
# 2. Generate App Password: https://myaccount.google.com/apppasswords
#    - Select "Mail" as the app
#    - Select "Other (Custom name)" as device
#    - Enter: "Hell University Reservation System"
#    - Copy the 16-character password (remove spaces)
# 3. Use the App Password in SMTP_PASSWORD below
#
# Environment-Specific Recommendations:
# Production: Use production email account (admin@huculturehub.com)
# Preview: Use test email or separate preview account
# Development: Use your personal test email or test account
#
# SMTP Configuration (Google Workspace/Gmail)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false

# Email account that SENDS emails (requires App Password)
# Production: admin@huculturehub.com (production account)
# Preview: test@huculturehub.com or preview account
# Development: your-test-email@gmail.com
# Example: SMTP_USER=admin@huculturehub.com
# Example: SMTP_USER=helluniversity.cm@gmail.com
SMTP_USER=your-email@yourdomain.com

# App Password (16 characters, NO SPACES)
# Generate separate app passwords for each environment if using different accounts
# Example: SMTP_PASSWORD=abcdefghijklmnop
# DO NOT use your regular Google password!
# Get your App Password from: https://myaccount.google.com/apppasswords
SMTP_PASSWORD=your-app-password-here

# Email address to RECEIVE reservation notifications (admin email)
# If not set, will default to SMTP_USER
# Production: reservations@huculturehub.com (production notifications)
# Preview: preview-reservations@huculturehub.com (test notifications)
# Development: your-test-email@gmail.com (local testing)
# Can be same as SMTP_USER or a different email address
# Example: RESERVATION_EMAIL=reservations@huculturehub.com
# Example: RESERVATION_EMAIL=helluniversity.cm@gmail.com
RESERVATION_EMAIL=reservations@yourdomain.com

# ============================================================================
# File Upload & Request Size Limits (in bytes)
# ============================================================================
# Maximum FormData size (for file uploads including metadata)
# Default: 20971520 (20MB)
# Recommended for batch uploads: 104857600 (100MB) to support multiple files
# For Vercel Hobby/Pro with 4.5MB limit: 4718592 (4.5MB) - upload 1 image at a time
# For Vercel Enterprise (no limit): 53687091200 (50GB) - upload 500 images per batch
# Note: Vercel Hobby/Pro plans have 4.5MB hard limit for request body (cannot be overridden)
MAX_FORMDATA_SIZE=20971520

# Maximum JSON request body size
# Default: 1048576 (1MB)
MAX_REQUEST_BODY_SIZE=1048576

# Maximum image file size (for validation) - ORIGINAL file size before processing
# Default: 20971520 (20MB)
# Recommended for large originals: 104857600 (100MB) to allow 100MB original images
# Note: Client-side processing will reduce this before upload
MAX_IMAGE_FILE_SIZE=20971520

# Maximum processed image size (after compression/resize) - PROCESSED file size
# Default: 5242880 (5MB)
# Recommended for batch uploads: 10485760 (10MB) for higher quality processed images
# For Vercel Hobby/Pro with 4.5MB limit: 4613734 (4.4MB) - leaves room for metadata overhead
# For Vercel Enterprise: 10485760 (10MB) - allows higher quality
MAX_IMAGE_PROCESSED_SIZE=5242880

# Maximum thumbnail size
# Default: 512000 (500KB)
MAX_IMAGE_THUMBNAIL_SIZE=512000

# Maximum email metadata size (JSON string in email_queue table)
# Default: 102400 (100KB)
MAX_EMAIL_METADATA_SIZE=102400

# Client-side file size limit (for frontend validation)
# Must be prefixed with NEXT_PUBLIC_ to be accessible in browser
# Default: 20971520 (20MB)
# Recommended for large originals: 104857600 (100MB) to match MAX_IMAGE_FILE_SIZE
# Note: Should match MAX_IMAGE_FILE_SIZE for consistency
# Client-side processing will reduce images before upload
NEXT_PUBLIC_MAX_IMAGE_FILE_SIZE=20971520

# ============================================================================
# Batch Image Upload Configuration
# ============================================================================
# Maximum number of files allowed in a single batch upload request
# Default: 50
# For Vercel Hobby/Pro with 4.5MB limit: 1 (upload 1 image at a time)
# For Vercel Enterprise: 500 (upload 500 images per batch for 50GB total)
# Prevents excessively large single requests that can strain network and server resources
# Note: Frontend will automatically split batches based on file sizes and this limit
MAX_FILES_PER_BATCH=50

# Client-side maximum files per batch (for frontend batch splitting)
# Must be prefixed with NEXT_PUBLIC_ to be accessible in browser
# Should match MAX_FILES_PER_BATCH for consistency
# Frontend uses this to intelligently split images into batches
NEXT_PUBLIC_MAX_FILES_PER_BATCH=50

# Client-side maximum FormData size (for frontend batch splitting)
# Must be prefixed with NEXT_PUBLIC_ to be accessible in browser
# Default: 4718592 (4.5MB) - Vercel Hobby/Pro hard limit
# For Vercel Enterprise: Set to a higher value (e.g., 53687091200 for 50GB)
# Frontend uses this to calculate how many images fit per batch
NEXT_PUBLIC_MAX_FORMDATA_SIZE=4718592

# Maximum number of images to process concurrently on the server within a batch
# Default: 5
# Limits simultaneous CPU and memory usage on the server, preventing resource exhaustion
# while still leveraging parallelism for faster processing than purely sequential
# Higher values = faster processing but more server load
# Lower values = slower processing but more stable server performance
# For single uploads (MAX_FILES_PER_BATCH=1): This setting is not used
MAX_CONCURRENT_PROCESSING=5

# ============================================================================
# Client-Side Image Processing Configuration
# ============================================================================
# Maximum width for client-side image resizing (in pixels)
# Default: 1920
# For aggressive compression (100MB → 4.4MB): 1600
# Lower values = smaller file sizes but lower quality
# Must be prefixed with NEXT_PUBLIC_ to be accessible in browser
NEXT_PUBLIC_MAX_IMAGE_WIDTH=1920

# Maximum height for client-side image resizing (in pixels)
# Default: 1920
# For aggressive compression (100MB → 4.4MB): 1600
# Lower values = smaller file sizes but lower quality
# Must be prefixed with NEXT_PUBLIC_ to be accessible in browser
NEXT_PUBLIC_MAX_IMAGE_HEIGHT=1920

# Image quality for client-side compression (0.0 to 1.0)
# Default: 0.85 (85%)
# For aggressive compression (100MB → 4.4MB): 0.70 (70%)
# Lower values = smaller file sizes but lower quality
# Must be prefixed with NEXT_PUBLIC_ to be accessible in browser
NEXT_PUBLIC_IMAGE_QUALITY=0.85

# Image format for client-side processing
# Options: 'webp' (recommended, best compression), 'jpeg', 'png'
# Default: 'webp'
# Must be prefixed with NEXT_PUBLIC_ to be accessible in browser
NEXT_PUBLIC_IMAGE_FORMAT=webp

# ============================================================================
# Email Queue Configuration
# ============================================================================
# Rate limit for email queue processing (emails per minute)
# Default: 30
EMAIL_QUEUE_RATE_LIMIT=30

# ============================================================================
# Vercel Cron Jobs Configuration
# ============================================================================
# CRON_SECRET: Secret token for authenticating Vercel cron job requests
# 
# IMPORTANT: This MUST be set in Vercel Dashboard for cron jobs to work!
# 
# Setup Instructions:
# 1. Generate a secure random string:
#    - Mac/Linux: openssl rand -hex 32
#    - Node.js: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# 2. Set in Vercel Dashboard:
#    - Go to: Vercel Dashboard → Your Project → Settings → Environment Variables
#    - Add: CRON_SECRET = <your-generated-secret>
#    - Apply to: Production, Preview, Development (all environments)
# 3. Vercel automatically sends this in Authorization header when calling cron jobs
# 
# NOTE: Vercel cron jobs:
# - Only work on Pro plans or higher (not Free/Hobby)
# - Only run in PRODUCTION deployments (not preview)
# - Must be configured in vercel.json (already done)
# - Must have CRON_SECRET set in environment variables
# 
# If you're on Free/Hobby plan, use external cron services instead
# See: docs/01-Setup-Configuration/VERCEL_CRON_SETUP.md
CRON_SECRET=your-cron-secret-here

# ============================================================================
# Email Configuration Examples:
# ============================================================================
# 
# Option 1: Same email for sending and receiving
# SMTP_USER=helluniversity.cm@gmail.com
# SMTP_PASSWORD=abcdefghijklmnop
# RESERVATION_EMAIL=helluniversity.cm@gmail.com
# (or omit RESERVATION_EMAIL to use SMTP_USER)
#
# Option 2: Different emails
# SMTP_USER=noreply@huculturehub.com          # Sender
# SMTP_PASSWORD=abcdefghijklmnop                # App password for sender
# RESERVATION_EMAIL=reservations@huculturehub.com  # Admin receiver
#
# ============================================================================
# Notes:
# - Copy this file to .env.local and fill in your actual values
# - Never commit .env.local to version control (already in .gitignore)
# - Restart your development server after changing environment variables
# 
# Environment Setup:
# - See ENVIRONMENT_SETUP_GUIDE.md for comprehensive environment setup
# - Set different values for Production, Preview, and Development in Vercel
# - Use separate databases for each environment (IMPORTANT!)
# 
# Database Setup:
# - See DATABASE_SETUP.md for detailed setup instructions
# - Production: libsql://your-production-db.turso.io
# - Preview: libsql://your-preview-db.turso.io
# - Development: file:./local.db (local file)
# 
# Blob Storage:
# - Automatically configured when using Vercel Blob Storage
# - BLOB_READ_WRITE_TOKEN is auto-set in Vercel deployments
# - Same blob storage is used across all environments (can be separated if needed)
# ============================================================================
